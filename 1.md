# 数论四大定理的详细证明

## 预备知识 1：贝祖定理（Bézout's Identity）的证明

### 贝祖定理的陈述

设 <img src="https://www.zhihu.com/equation?tex=%20%20a%2C%20b%20%20" alt="  a, b  " class="ee_img tr_noresize" eeimg="1"> 为两个不全为零的整数，记 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%3D%20%5Cgcd%28a%2C%20b%29%20%20" alt="  d = \gcd(a, b)  " class="ee_img tr_noresize" eeimg="1"> 为它们的最大公约数，则存在整数 <img src="https://www.zhihu.com/equation?tex=%20%20x%2C%20y%20%20" alt="  x, y  " class="ee_img tr_noresize" eeimg="1">，使得：

<img src="https://www.zhihu.com/equation?tex=%20a%20x%20%2B%20b%20y%20%3D%20d.%20%5C%5C" alt=" a x + b y = d. \\" class="ee_img tr_noresize" eeimg="1">

特别地，若 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%20" alt="  a  " class="ee_img tr_noresize" eeimg="1"> 和 <img src="https://www.zhihu.com/equation?tex=%20%20b%20%20" alt="  b  " class="ee_img tr_noresize" eeimg="1"> 互质（即 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%3D%201%20%20" alt="  d = 1  " class="ee_img tr_noresize" eeimg="1">），则存在整数 <img src="https://www.zhihu.com/equation?tex=%20%20x%2C%20y%20%20" alt="  x, y  " class="ee_img tr_noresize" eeimg="1">，使得：

<img src="https://www.zhihu.com/equation?tex=%20a%20x%20%2B%20b%20y%20%3D%201.%20%5C%5C" alt=" a x + b y = 1. \\" class="ee_img tr_noresize" eeimg="1">

### 证明步骤

#### 第一步：证明存在性（存在整数 
<img src="https://www.zhihu.com/equation?tex=%20%20x%2C%20y%20%20" alt="  x, y  " class="ee_img tr_noresize" eeimg="1">
 使得 
<img src="https://www.zhihu.com/equation?tex=%20%20a%20x%20%2B%20b%20y%20%3D%20d%20%20" alt="  a x + b y = d  " class="ee_img tr_noresize" eeimg="1">
）

**方法**：借助欧几里得算法的步骤反向构造 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%20" alt="  x  " class="ee_img tr_noresize" eeimg="1"> 和 <img src="https://www.zhihu.com/equation?tex=%20%20y%20%20" alt="  y  " class="ee_img tr_noresize" eeimg="1">。

**欧几里得算法的回顾**通过反复运用带余除法，可逐步求出 <img src="https://www.zhihu.com/equation?tex=%20%20%5Cgcd%28a%2C%20b%29%20%20" alt="  \gcd(a, b)  " class="ee_img tr_noresize" eeimg="1">。具体过程如下：

$ 
\begin{align*}
a &= b q_1 + r_1 \quad (0 < r_1 < |b|), \\
b &= r_1 q_2 + r_2 \quad (0 < r_2 < r_1), \\
r_1 &= r_2 q_3 + r_3 \quad (0 < r_3 < r_2), \\
&\vdots \\
r_{n - 2} &= r_{n - 1} q_n + r_n \quad (0 < r_n < r_{n - 1}), \\
r_{n - 1} &= r_n q_{n + 1} + 0.
\end{align*}
 $

当余数为 <img src="https://www.zhihu.com/equation?tex=%20%200%20%20" alt="  0  " class="ee_img tr_noresize" eeimg="1"> 时，最后一个非零余数 <img src="https://www.zhihu.com/equation?tex=%20%20r_n%20%20" alt="  r_n  " class="ee_img tr_noresize" eeimg="1"> 就是 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%20" alt="  a  " class="ee_img tr_noresize" eeimg="1"> 和 <img src="https://www.zhihu.com/equation?tex=%20%20b%20%20" alt="  b  " class="ee_img tr_noresize" eeimg="1"> 的最大公约数，即 <img src="https://www.zhihu.com/equation?tex=%20%20r_n%20%3D%20%5Cgcd%28a%2C%20b%29%20%3D%20d%20%20" alt="  r_n = \gcd(a, b) = d  " class="ee_img tr_noresize" eeimg="1"> 。

**反向代入构造线性组合**从最后一个非零余数 <img src="https://www.zhihu.com/equation?tex=%20%20r_n%20%3D%20d%20%20" alt="  r_n = d  " class="ee_img tr_noresize" eeimg="1"> 出发，将每个余数表示为前两步的线性组合，再逐步回代至初始方程。

例如，先有 <img src="https://www.zhihu.com/equation?tex=%20%20r_n%20%3D%20r_%7Bn%20-%202%7D%20-%20r_%7Bn%20-%201%7D%20q_n%20%20" alt="  r_n = r_{n - 2} - r_{n - 1} q_n  " class="ee_img tr_noresize" eeimg="1"> ；

然后把 <img src="https://www.zhihu.com/equation?tex=%20%20r_%7Bn%20-%201%7D%20%3D%20r_%7Bn%20-%203%7D%20-%20r_%7Bn%20-%202%7D%20q_%7Bn%20-%201%7D%20%20" alt="  r_{n - 1} = r_{n - 3} - r_{n - 2} q_{n - 1}  " class="ee_img tr_noresize" eeimg="1"> 代入上式；

不断重复此过程，最终就能将 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%20" alt="  d  " class="ee_img tr_noresize" eeimg="1"> 表示成 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%20" alt="  a  " class="ee_img tr_noresize" eeimg="1"> 和 <img src="https://www.zhihu.com/equation?tex=%20%20b%20%20" alt="  b  " class="ee_img tr_noresize" eeimg="1"> 的线性组合形式。

**具体构造示例**以 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%3D%20252%20%20" alt="  a = 252  " class="ee_img tr_noresize" eeimg="1">，<img src="https://www.zhihu.com/equation?tex=%20%20b%20%3D%20198%20%20" alt="  b = 198  " class="ee_img tr_noresize" eeimg="1"> 为例来计算 <img src="https://www.zhihu.com/equation?tex=%20%20%5Cgcd%28252%2C%20198%29%20%20" alt="  \gcd(252, 198)  " class="ee_img tr_noresize" eeimg="1"> ：

$ 
\begin{align*}
252 &= 198 \cdot 1 + 54, \\
198 &= 54 \cdot 3 + 36, \\
54 &= 36 \cdot 1 + 18, \\
36 &= 18 \cdot 2 + 0.
\end{align*}
 $

由此可知最大公约数 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%3D%2018%20%20" alt="  d = 18  " class="ee_img tr_noresize" eeimg="1"> 。接着反向代入：

$ 
\begin{align*}
18 &= 54 - 36 \cdot 1 \\
&= 54 - (198 - 54 \cdot 3) \cdot 1 \\
&= 54 \cdot 4 - 198 \cdot 1 \\
&= (252 - 198 \cdot 1) \cdot 4 - 198 \cdot 1 \\
&= 252 \cdot 4 - 198 \cdot 5
\end{align*}
 $

这样就找到了 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%3D%204%20%20" alt="  x = 4  " class="ee_img tr_noresize" eeimg="1">，<img src="https://www.zhihu.com/equation?tex=%20%20y%20%3D%20-5%20%20" alt="  y = -5  " class="ee_img tr_noresize" eeimg="1">，满足 <img src="https://www.zhihu.com/equation?tex=%20%20252%20%5Ccdot%204%20%2B%20198%20%5Ccdot%20%28-5%29%20%3D%2018%20%20" alt="  252 \cdot 4 + 198 \cdot (-5) = 18  " class="ee_img tr_noresize" eeimg="1"> 。

#### 第二步：唯一性（附加说明）

贝祖定理并不保证 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%20" alt="  x  " class="ee_img tr_noresize" eeimg="1"> 和 <img src="https://www.zhihu.com/equation?tex=%20%20y%20%20" alt="  y  " class="ee_img tr_noresize" eeimg="1"> 的取值是唯一的。例如，若 <img src="https://www.zhihu.com/equation?tex=%20%20a%20x%20%2B%20b%20y%20%3D%20d%20%20" alt="  a x + b y = d  " class="ee_img tr_noresize" eeimg="1"> 成立，那么对于任意整数 <img src="https://www.zhihu.com/equation?tex=%20%20k%20%20" alt="  k  " class="ee_img tr_noresize" eeimg="1"> ，都有：

<img src="https://www.zhihu.com/equation?tex=%20a%20%5Cleft%28%20x%20%2B%20k%20%5Ccdot%20%5Cfrac%7Bb%7D%7Bd%7D%20%5Cright%29%20%2B%20b%20%5Cleft%28%20y%20-%20k%20%5Ccdot%20%5Cfrac%7Ba%7D%7Bd%7D%20%5Cright%29%20%3D%20d.%20%5C%5C" alt=" a \left( x + k \cdot \frac{b}{d} \right) + b \left( y - k \cdot \frac{a}{d} \right) = d. \\" class="ee_img tr_noresize" eeimg="1">

由此可见，贝祖定理的解存在无穷多组。

**注**：若 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%20" alt="  a  " class="ee_img tr_noresize" eeimg="1"> 和 <img src="https://www.zhihu.com/equation?tex=%20%20b%20%20" alt="  b  " class="ee_img tr_noresize" eeimg="1"> 中有一个为零，定理依然成立。例如，若 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%3D%200%20%20" alt="  a = 0  " class="ee_img tr_noresize" eeimg="1">，则 <img src="https://www.zhihu.com/equation?tex=%20%20%5Cgcd%280%2C%20b%29%20%3D%20%7Cb%7C%20%20" alt="  \gcd(0, b) = |b|  " class="ee_img tr_noresize" eeimg="1">，此时 <img src="https://www.zhihu.com/equation?tex=%20%200%20%5Ccdot%20x%20%2B%20b%20%5Ccdot%201%20%3D%20%7Cb%7C%20%20" alt="  0 \cdot x + b \cdot 1 = |b|  " class="ee_img tr_noresize" eeimg="1">。

## 预备知识 2：模 
<img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1">
 乘法群 
<img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BZ%7D_p%5E%2A" alt="\mathbb{Z}_p^*" class="ee_img tr_noresize" eeimg="1">
 中逆元的存在性与唯一性

在模 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 的乘法群 <img src="https://www.zhihu.com/equation?tex=%5Cmathbb%7BZ%7D_p%5E%2A%20%3D%20%5C%7B1%2C%202%2C%20%5Cldots%2C%20p%20-%201%5C%7D" alt="\mathbb{Z}_p^* = \{1, 2, \ldots, p - 1\}" class="ee_img tr_noresize" eeimg="1"> 中（<img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 为素数），对于每个元素 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%20" alt="  x  " class="ee_img tr_noresize" eeimg="1">，都有且仅有一个逆元 <img src="https://www.zhihu.com/equation?tex=%20%20y%20%5Cin%20%5Cmathbb%7BZ%7D_p%5E%2A%20%20" alt="  y \in \mathbb{Z}_p^*  " class="ee_img tr_noresize" eeimg="1">，使得 <img src="https://www.zhihu.com/equation?tex=%20%20x%20y%20%5Cequiv%201%20%5Cpmod%7Bp%7D%20%20" alt="  x y \equiv 1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">。下面从逆元的存在性和唯一性两方面展开证明。

### 1. 逆元的存在性

**核心思路**：借助贝祖定理和素数性质构造逆元。

因为 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 是素数，而 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%5Cin%20%5Cmathbb%7BZ%7D_p%5E%2A%20%20" alt="  x \in \mathbb{Z}_p^*  " class="ee_img tr_noresize" eeimg="1">，这意味着 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%20" alt="  x  " class="ee_img tr_noresize" eeimg="1"> 的取值范围是 <img src="https://www.zhihu.com/equation?tex=%20%201%20%20" alt="  1  " class="ee_img tr_noresize" eeimg="1"> 到 <img src="https://www.zhihu.com/equation?tex=%20%20p%20-%201%20%20" alt="  p - 1  " class="ee_img tr_noresize" eeimg="1"> ，所以 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%20" alt="  x  " class="ee_img tr_noresize" eeimg="1"> 与 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 不存在除 <img src="https://www.zhihu.com/equation?tex=%20%201%20%20" alt="  1  " class="ee_img tr_noresize" eeimg="1"> 以外的公因数，即 <img src="https://www.zhihu.com/equation?tex=%5Cgcd%28x%2C%20p%29%20%3D%201" alt="\gcd(x, p) = 1" class="ee_img tr_noresize" eeimg="1"> 。

依据贝祖定理，对于两个互质的整数 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%20" alt="  x  " class="ee_img tr_noresize" eeimg="1"> 和 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> ，必定存在整数 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%20" alt="  a  " class="ee_img tr_noresize" eeimg="1"> 和 <img src="https://www.zhihu.com/equation?tex=%20%20b%20%20" alt="  b  " class="ee_img tr_noresize" eeimg="1"> ，满足 <img src="https://www.zhihu.com/equation?tex=%20%20a%20x%20%2B%20b%20p%20%3D%201%20%20" alt="  a x + b p = 1  " class="ee_img tr_noresize" eeimg="1"> 。

在模 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 运算体系下，等式 <img src="https://www.zhihu.com/equation?tex=%20%20a%20x%20%2B%20b%20p%20%3D%201%20%20" alt="  a x + b p = 1  " class="ee_img tr_noresize" eeimg="1"> 两边同时对 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 取模 。由于 <img src="https://www.zhihu.com/equation?tex=%20%20b%20p%20%5Cequiv%200%20%5Cpmod%7Bp%7D%20%20" alt="  b p \equiv 0 \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> ，所以可得 <img src="https://www.zhihu.com/equation?tex=%20%20a%20x%20%5Cequiv%201%20%5Cpmod%7Bp%7D%20%20" alt="  a x \equiv 1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> 。

此时，令 <img src="https://www.zhihu.com/equation?tex=%20%20y%20%3D%20a%20%5Cbmod%7Bp%7D%20%20" alt="  y = a \bmod{p}  " class="ee_img tr_noresize" eeimg="1"> 。因为 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%20" alt="  a  " class="ee_img tr_noresize" eeimg="1"> 是整数，对其进行模 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 运算后， <img src="https://www.zhihu.com/equation?tex=%20%20y%20%20" alt="  y  " class="ee_img tr_noresize" eeimg="1"> 的取值范围在 <img src="https://www.zhihu.com/equation?tex=%20%200%20%20" alt="  0  " class="ee_img tr_noresize" eeimg="1"> 到 <img src="https://www.zhihu.com/equation?tex=%20%20p%20-%201%20%20" alt="  p - 1  " class="ee_img tr_noresize" eeimg="1"> 之间，又因为 <img src="https://www.zhihu.com/equation?tex=%20%20a%20x%20%5Cequiv%201%20%5Cpmod%7Bp%7D%20%20" alt="  a x \equiv 1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> ，所以 <img src="https://www.zhihu.com/equation?tex=%20%20y%20%5Cneq%200%20%20" alt="  y \neq 0  " class="ee_img tr_noresize" eeimg="1"> ，即 <img src="https://www.zhihu.com/equation?tex=%20%20y%20%5Cin%20%5Cmathbb%7BZ%7D_p%5E%2A%20%20" alt="  y \in \mathbb{Z}_p^*  " class="ee_img tr_noresize" eeimg="1"> ，并且满足 <img src="https://www.zhihu.com/equation?tex=%20%20x%20y%20%5Cequiv%20x%20a%20%5Cequiv%201%20%5Cpmod%7Bp%7D%20%20" alt="  x y \equiv x a \equiv 1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> 。由此可知，对于任意的 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%5Cin%20%5Cmathbb%7BZ%7D_p%5E%2A%20%20" alt="  x \in \mathbb{Z}_p^*  " class="ee_img tr_noresize" eeimg="1"> ，都能找到这样的 <img src="https://www.zhihu.com/equation?tex=%20%20y%20%20" alt="  y  " class="ee_img tr_noresize" eeimg="1"> 作为其逆元，逆元存在性得证。

### 2. 逆元的唯一性

**核心思路**：利用模运算消去律，通过反证法证明逆元唯一。

假设存在两个不同的逆元 <img src="https://www.zhihu.com/equation?tex=%20%20y%2C%20z%20%5Cin%20%5Cmathbb%7BZ%7D_p%5E%2A%20%20" alt="  y, z \in \mathbb{Z}_p^*  " class="ee_img tr_noresize" eeimg="1"> ，使得 <img src="https://www.zhihu.com/equation?tex=%20%20x%20y%20%5Cequiv%201%20%5Cpmod%7Bp%7D%20%20" alt="  x y \equiv 1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> 且 <img src="https://www.zhihu.com/equation?tex=%20%20x%20z%20%5Cequiv%201%20%5Cpmod%7Bp%7D%20%20" alt="  x z \equiv 1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> 。

将这两个同余等式相减，即 <img src="https://www.zhihu.com/equation?tex=%20%20x%20y%20-%20x%20z%20%5Cequiv%201%20-%201%20%5Cpmod%7Bp%7D%20%20" alt="  x y - x z \equiv 1 - 1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> ，根据同余运算的性质，可化简为 <img src="https://www.zhihu.com/equation?tex=%20%20x%20y%20-%20x%20z%20%5Cequiv%200%20%5Cpmod%7Bp%7D%20%20" alt="  x y - x z \equiv 0 \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> ，再进一步因式分解得到 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%28y%20-%20z%29%20%5Cequiv%200%20%5Cpmod%7Bp%7D%20%20" alt="  x (y - z) \equiv 0 \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> 。

由于前面已得出 <img src="https://www.zhihu.com/equation?tex=%5Cgcd%28x%2C%20p%29%20%3D%201" alt="\gcd(x, p) = 1" class="ee_img tr_noresize" eeimg="1"> ，根据模运算的消去律（若 <img src="https://www.zhihu.com/equation?tex=%20%20ac%20%5Cequiv%20bc%20%5Cpmod%7Bm%7D%20%20" alt="  ac \equiv bc \pmod{m}  " class="ee_img tr_noresize" eeimg="1"> 且 <img src="https://www.zhihu.com/equation?tex=%5Cgcd%28c%2C%20m%29%20%3D%201" alt="\gcd(c, m) = 1" class="ee_img tr_noresize" eeimg="1"> ，则 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%5Cequiv%20b%20%5Cpmod%7Bm%7D%20%20" alt="  a \equiv b \pmod{m}  " class="ee_img tr_noresize" eeimg="1"> ），在同余式 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%28y%20-%20z%29%20%5Cequiv%200%20%5Cpmod%7Bp%7D%20%20" alt="  x (y - z) \equiv 0 \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> 中，可将 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%20" alt="  x  " class="ee_img tr_noresize" eeimg="1"> 消去，得到 <img src="https://www.zhihu.com/equation?tex=%20%20y%20-%20z%20%5Cequiv%200%20%5Cpmod%7Bp%7D%20%20" alt="  y - z \equiv 0 \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> ，这就意味着 <img src="https://www.zhihu.com/equation?tex=%20%20y%20%5Cequiv%20z%20%5Cpmod%7Bp%7D%20%20" alt="  y \equiv z \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> 。

而在模 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 乘法群 $\mathbb{Z}_p^*<img src="https://www.zhihu.com/equation?tex=%20%E4%B8%AD%EF%BC%8C%E5%85%83%E7%B4%A0%E6%98%AF%E5%9C%A8%20" alt=" 中，元素是在 " class="ee_img tr_noresize" eeimg="1">  1  <img src="https://www.zhihu.com/equation?tex=%20%E5%88%B0%20" alt=" 到 " class="ee_img tr_noresize" eeimg="1">  p - 1  <img src="https://www.zhihu.com/equation?tex=%20%E8%8C%83%E5%9B%B4%E5%86%85%EF%BC%8C%E5%BD%93%20" alt=" 范围内，当 " class="ee_img tr_noresize" eeimg="1">  y \equiv z \pmod{p}  <img src="https://www.zhihu.com/equation?tex=%20%E6%97%B6%EF%BC%8C%E5%B0%B1%E8%A1%A8%E7%A4%BA%20" alt=" 时，就表示 " class="ee_img tr_noresize" eeimg="1">  y = z  <img src="https://www.zhihu.com/equation?tex=%20%EF%BC%8C%E8%BF%99%E4%B8%8E%E6%88%91%E4%BB%AC%E5%81%87%E8%AE%BE%E7%9A%84%20" alt=" ，这与我们假设的 " class="ee_img tr_noresize" eeimg="1">  y  <img src="https://www.zhihu.com/equation?tex=%20%E5%92%8C%20" alt=" 和 " class="ee_img tr_noresize" eeimg="1">  z  <img src="https://www.zhihu.com/equation?tex=%20%E6%98%AF%E4%B8%A4%E4%B8%AA%E4%B8%8D%E5%90%8C%E7%9A%84%E9%80%86%E5%85%83%E7%9B%B8%E7%9F%9B%E7%9B%BE%E3%80%82%E6%89%80%E4%BB%A5%EF%BC%8C%E5%9C%A8%20" alt=" 是两个不同的逆元相矛盾。所以，在 " class="ee_img tr_noresize" eeimg="1">\mathbb{Z}_p^*$ 中，每个元素的逆元是唯一的。

## 一、费马小定理（Fermat's Little Theorem）

**定理**：若 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 为素数，且 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%20" alt="  a  " class="ee_img tr_noresize" eeimg="1"> 与 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 互质（即 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%5Cnmid%20a%20%20" alt="  p \nmid a  " class="ee_img tr_noresize" eeimg="1">），则

<img src="https://www.zhihu.com/equation?tex=%20a%5E%7Bp%20-%201%7D%20%5Cequiv%201%20%5Cpmod%7Bp%7D.%20%5C%5C" alt=" a^{p - 1} \equiv 1 \pmod{p}. \\" class="ee_img tr_noresize" eeimg="1">

**证明**：首先，定义集合 <img src="https://www.zhihu.com/equation?tex=%20%20S%20%3D%20%5C%7B1%2C%202%2C%203%2C%20%5Cldots%2C%20p%20-%201%5C%7D%20%20" alt="  S = \{1, 2, 3, \ldots, p - 1\}  " class="ee_img tr_noresize" eeimg="1">，此集合是模 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 的简化剩余系。因为 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%20" alt="  a  " class="ee_img tr_noresize" eeimg="1"> 与 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 互质，根据同余的性质，对于集合 <img src="https://www.zhihu.com/equation?tex=%20%20S%20%20" alt="  S  " class="ee_img tr_noresize" eeimg="1"> 中的任意元素 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%20" alt="  x  " class="ee_img tr_noresize" eeimg="1">，<img src="https://www.zhihu.com/equation?tex=%20%20a%20%5Ccdot%20x%20%20" alt="  a \cdot x  " class="ee_img tr_noresize" eeimg="1"> 模 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 的结果依然在集合 <img src="https://www.zhihu.com/equation?tex=%20%20S%20%20" alt="  S  " class="ee_img tr_noresize" eeimg="1"> 内，并且这些结果互不相同。

采用反证法来证明这一点：假设存在 <img src="https://www.zhihu.com/equation?tex=%20%20x_1%20%5Cneq%20x_2%20%20" alt="  x_1 \neq x_2  " class="ee_img tr_noresize" eeimg="1"> ，使得 <img src="https://www.zhihu.com/equation?tex=%20%20a%20x_1%20%5Cequiv%20a%20x_2%20%5Cpmod%7Bp%7D%20%20" alt="  a x_1 \equiv a x_2 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">。根据同余的运算法则，两边同时减去 <img src="https://www.zhihu.com/equation?tex=%20%20a%20x_2%20%20" alt="  a x_2  " class="ee_img tr_noresize" eeimg="1"> ，可得 <img src="https://www.zhihu.com/equation?tex=%20%20a%28x_1%20-%20x_2%29%20%5Cequiv%200%20%5Cpmod%7Bp%7D%20%20" alt="  a(x_1 - x_2) \equiv 0 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">。又因为 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%20" alt="  a  " class="ee_img tr_noresize" eeimg="1"> 与 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 互质，根据互质的性质，若 <img src="https://www.zhihu.com/equation?tex=%20%20ab%20%5Cequiv%200%20%5Cpmod%7Bm%7D%20%20" alt="  ab \equiv 0 \pmod{m}  " class="ee_img tr_noresize" eeimg="1"> 且 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%20" alt="  a  " class="ee_img tr_noresize" eeimg="1"> 与 <img src="https://www.zhihu.com/equation?tex=%20%20m%20%20" alt="  m  " class="ee_img tr_noresize" eeimg="1"> 互质，则 <img src="https://www.zhihu.com/equation?tex=%20%20b%20%5Cequiv%200%20%5Cpmod%7Bm%7D%20%20" alt="  b \equiv 0 \pmod{m}  " class="ee_img tr_noresize" eeimg="1"> ，所以 <img src="https://www.zhihu.com/equation?tex=%20%20x_1%20-%20x_2%20%5Cequiv%200%20%5Cpmod%7Bp%7D%20%20" alt="  x_1 - x_2 \equiv 0 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">，即 <img src="https://www.zhihu.com/equation?tex=%20%20x_1%20%5Cequiv%20x_2%20%5Cpmod%7Bp%7D%20%20" alt="  x_1 \equiv x_2 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">，这与假设 <img src="https://www.zhihu.com/equation?tex=%20%20x_1%20%5Cneq%20x_2%20%20" alt="  x_1 \neq x_2  " class="ee_img tr_noresize" eeimg="1"> 矛盾，所以集合 <img src="https://www.zhihu.com/equation?tex=%20%20%5C%7Ba%20%5Ccdot%201%2C%20a%20%5Ccdot%202%2C%20%5Cldots%2C%20a%20%5Ccdot%20%28p%20-%201%29%5C%7D%20%20" alt="  \{a \cdot 1, a \cdot 2, \ldots, a \cdot (p - 1)\}  " class="ee_img tr_noresize" eeimg="1"> 是 <img src="https://www.zhihu.com/equation?tex=%20%20S%20%20" alt="  S  " class="ee_img tr_noresize" eeimg="1"> 的一个排列。

接着，比较两个集合元素的乘积：

<img src="https://www.zhihu.com/equation?tex=%20%5Cprod_%7Bx%20%5Cin%20S%7D%20%28a%20%5Ccdot%20x%29%20%5Cequiv%20%5Cprod_%7Bx%20%5Cin%20S%7D%20x%20%5Cpmod%7Bp%7D.%20%5C%5C" alt=" \prod_{x \in S} (a \cdot x) \equiv \prod_{x \in S} x \pmod{p}. \\" class="ee_img tr_noresize" eeimg="1">

对左边进行展开，根据乘法结合律可得 <img src="https://www.zhihu.com/equation?tex=%20%20a%5E%7Bp%20-%201%7D%20%5Ccdot%20%28p%20-%201%29%21%20%20" alt="  a^{p - 1} \cdot (p - 1)!  " class="ee_img tr_noresize" eeimg="1">，右边为 <img src="https://www.zhihu.com/equation?tex=%20%20%28p%20-%201%29%21%20%20" alt="  (p - 1)!  " class="ee_img tr_noresize" eeimg="1">，所以有：

<img src="https://www.zhihu.com/equation?tex=%20a%5E%7Bp%20-%201%7D%20%5Ccdot%20%28p%20-%201%29%21%20%5Cequiv%20%28p%20-%201%29%21%20%5Cpmod%7Bp%7D.%20%5C%5C" alt=" a^{p - 1} \cdot (p - 1)! \equiv (p - 1)! \pmod{p}. \\" class="ee_img tr_noresize" eeimg="1">

由于 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 是素数，根据阶乘的性质，<img src="https://www.zhihu.com/equation?tex=%20%20%28p%20-%201%29%21%20%20" alt="  (p - 1)!  " class="ee_img tr_noresize" eeimg="1"> 与 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 互质。再根据同余的消去律，若 <img src="https://www.zhihu.com/equation?tex=%20%20ac%20%5Cequiv%20bc%20%5Cpmod%7Bm%7D%20%20" alt="  ac \equiv bc \pmod{m}  " class="ee_img tr_noresize" eeimg="1"> 且 <img src="https://www.zhihu.com/equation?tex=%20%20c%20%20" alt="  c  " class="ee_img tr_noresize" eeimg="1"> 与 <img src="https://www.zhihu.com/equation?tex=%20%20m%20%20" alt="  m  " class="ee_img tr_noresize" eeimg="1"> 互质，则 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%5Cequiv%20b%20%5Cpmod%7Bm%7D%20%20" alt="  a \equiv b \pmod{m}  " class="ee_img tr_noresize" eeimg="1"> ，两边同时约去 <img src="https://www.zhihu.com/equation?tex=%20%20%28p%20-%201%29%21%20%20" alt="  (p - 1)!  " class="ee_img tr_noresize" eeimg="1">，就可以得到：

<img src="https://www.zhihu.com/equation?tex=%20a%5E%7Bp%20-%201%7D%20%5Cequiv%201%20%5Cpmod%7Bp%7D.%20%5C%5C" alt=" a^{p - 1} \equiv 1 \pmod{p}. \\" class="ee_img tr_noresize" eeimg="1">

证毕。

## 二、中国剩余定理（Chinese Remainder Theorem, CRT）

**定理**：设 <img src="https://www.zhihu.com/equation?tex=%20%20m_1%2C%20m_2%2C%20%5Cldots%2C%20m_k%20%20" alt="  m_1, m_2, \ldots, m_k  " class="ee_img tr_noresize" eeimg="1"> 是两两互质的正整数，则对任意整数 <img src="https://www.zhihu.com/equation?tex=%20%20a_1%2C%20a_2%2C%20%5Cldots%2C%20a_k%20%20" alt="  a_1, a_2, \ldots, a_k  " class="ee_img tr_noresize" eeimg="1">，同余方程组：

<img src="https://www.zhihu.com/equation?tex=%20%5Cbegin%7Bcases%7Dx%20%5Cequiv%20a_1%20%5Cpmod%7Bm_1%7D%2C%20%5C%5Cx%20%5Cequiv%20a_2%20%5Cpmod%7Bm_2%7D%2C%20%5C%5C%5Cquad%20%5Cvdots%20%5C%5Cx%20%5Cequiv%20a_k%20%5Cpmod%7Bm_k%7D%5Cend%7Bcases%7D%20%5C%5C" alt=" \begin{cases}x \equiv a_1 \pmod{m_1}, \\x \equiv a_2 \pmod{m_2}, \\\quad \vdots \\x \equiv a_k \pmod{m_k}\end{cases} \\" class="ee_img tr_noresize" eeimg="1">

在模 <img src="https://www.zhihu.com/equation?tex=%20%20M%20%3D%20m_1%20m_2%20%5Ccdots%20m_k%20%20" alt="  M = m_1 m_2 \cdots m_k  " class="ee_img tr_noresize" eeimg="1"> 下有唯一解。

**证明**：**存在性**：对于每个 <img src="https://www.zhihu.com/equation?tex=%20%20i%20%20" alt="  i  " class="ee_img tr_noresize" eeimg="1"> ，定义 <img src="https://www.zhihu.com/equation?tex=%20%20M_i%20%3D%20M%20/%20m_i%20%20" alt="  M_i = M / m_i  " class="ee_img tr_noresize" eeimg="1">。因为 <img src="https://www.zhihu.com/equation?tex=%20%20m_i%20%20" alt="  m_i  " class="ee_img tr_noresize" eeimg="1"> 与 <img src="https://www.zhihu.com/equation?tex=%20%20M_i%20%20" alt="  M_i  " class="ee_img tr_noresize" eeimg="1"> 互质，根据预备知识2，我们知道存在整数 <img src="https://www.zhihu.com/equation?tex=%20%20t_i%20%20" alt="  t_i  " class="ee_img tr_noresize" eeimg="1"> 使得：

<img src="https://www.zhihu.com/equation?tex=%20M_i%20t_i%20%5Cequiv%201%20%5Cpmod%7Bm_i%7D.%20%5C%5C" alt=" M_i t_i \equiv 1 \pmod{m_i}. \\" class="ee_img tr_noresize" eeimg="1">

构造解 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%3D%20%5Csum_%7Bj%20%3D%201%7D%5Ek%20a_j%20M_j%20t_j%20%20" alt="  x = \sum_{j = 1}^k a_j M_j t_j  " class="ee_img tr_noresize" eeimg="1">。对于每个模 <img src="https://www.zhihu.com/equation?tex=%20%20m_i%20%20" alt="  m_i  " class="ee_img tr_noresize" eeimg="1"> ，当 <img src="https://www.zhihu.com/equation?tex=%20%20j%20%5Cneq%20i%20%20" alt="  j \neq i  " class="ee_img tr_noresize" eeimg="1"> 时，由于 <img src="https://www.zhihu.com/equation?tex=%20%20M_j%20%3D%20M%20/%20m_j%20%20" alt="  M_j = M / m_j  " class="ee_img tr_noresize" eeimg="1"> 且 <img src="https://www.zhihu.com/equation?tex=%20%20m_i%20%5Cmid%20M%20%20" alt="  m_i \mid M  " class="ee_img tr_noresize" eeimg="1">（因为 <img src="https://www.zhihu.com/equation?tex=%20%20M%20%3D%20m_1%20m_2%20%5Ccdots%20m_k%20%20" alt="  M = m_1 m_2 \cdots m_k  " class="ee_img tr_noresize" eeimg="1"> ），所以 <img src="https://www.zhihu.com/equation?tex=%20%20M_j%20%20" alt="  M_j  " class="ee_img tr_noresize" eeimg="1"> 是 <img src="https://www.zhihu.com/equation?tex=%20%20m_i%20%20" alt="  m_i  " class="ee_img tr_noresize" eeimg="1"> 的倍数，那么 <img src="https://www.zhihu.com/equation?tex=%20%20a_j%20M_j%20t_j%20%5Cequiv%200%20%5Cpmod%7Bm_i%7D%20%20" alt="  a_j M_j t_j \equiv 0 \pmod{m_i}  " class="ee_img tr_noresize" eeimg="1">。因此，<img src="https://www.zhihu.com/equation?tex=%20%20x%20%5Cequiv%20a_i%20M_i%20t_i%20%5Cpmod%7Bm_i%7D%20%20" alt="  x \equiv a_i M_i t_i \pmod{m_i}  " class="ee_img tr_noresize" eeimg="1">。又因为 <img src="https://www.zhihu.com/equation?tex=%20%20M_i%20t_i%20%5Cequiv%201%20%5Cpmod%7Bm_i%7D%20%20" alt="  M_i t_i \equiv 1 \pmod{m_i}  " class="ee_img tr_noresize" eeimg="1">，所以 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%5Cequiv%20a_i%20%5Cpmod%7Bm_i%7D%20%20" alt="  x \equiv a_i \pmod{m_i}  " class="ee_img tr_noresize" eeimg="1">，这就证明了解的存在性。

**唯一性**：假设 <img src="https://www.zhihu.com/equation?tex=%20%20x_1%20%20" alt="  x_1  " class="ee_img tr_noresize" eeimg="1"> 和 <img src="https://www.zhihu.com/equation?tex=%20%20x_2%20%20" alt="  x_2  " class="ee_img tr_noresize" eeimg="1"> 均为该同余方程组的解，则 <img src="https://www.zhihu.com/equation?tex=%20%20x_1%20-%20x_2%20%5Cequiv%200%20%5Cpmod%7Bm_i%7D%20%20" alt="  x_1 - x_2 \equiv 0 \pmod{m_i}  " class="ee_img tr_noresize" eeimg="1"> 对所有 <img src="https://www.zhihu.com/equation?tex=%20%20i%20%20" alt="  i  " class="ee_img tr_noresize" eeimg="1"> 成立。这意味着 <img src="https://www.zhihu.com/equation?tex=%20%20m_i%20%5Cmid%20%28x_1%20-%20x_2%29%20%20" alt="  m_i \mid (x_1 - x_2)  " class="ee_img tr_noresize" eeimg="1"> 对所有 <img src="https://www.zhihu.com/equation?tex=%20%20i%20%20" alt="  i  " class="ee_img tr_noresize" eeimg="1"> 成立。由于 <img src="https://www.zhihu.com/equation?tex=%20%20m_1%2C%20m_2%2C%20%5Cldots%2C%20m_k%20%20" alt="  m_1, m_2, \ldots, m_k  " class="ee_img tr_noresize" eeimg="1"> 两两互质，根据最小公倍数的性质，若 <img src="https://www.zhihu.com/equation?tex=%20%20m_i%20%5Cmid%20n%20%20" alt="  m_i \mid n  " class="ee_img tr_noresize" eeimg="1"> 且 <img src="https://www.zhihu.com/equation?tex=%20%20m_i%20%20" alt="  m_i  " class="ee_img tr_noresize" eeimg="1"> 两两互质，则 <img src="https://www.zhihu.com/equation?tex=%20%20m_1%20m_2%20%5Ccdots%20m_k%20%5Cmid%20n%20%20" alt="  m_1 m_2 \cdots m_k \mid n  " class="ee_img tr_noresize" eeimg="1"> ，所以 <img src="https://www.zhihu.com/equation?tex=%20%20M%20%5Cmid%20%28x_1%20-%20x_2%29%20%20" alt="  M \mid (x_1 - x_2)  " class="ee_img tr_noresize" eeimg="1">，即 <img src="https://www.zhihu.com/equation?tex=%20%20x_1%20%5Cequiv%20x_2%20%5Cpmod%7BM%7D%20%20" alt="  x_1 \equiv x_2 \pmod{M}  " class="ee_img tr_noresize" eeimg="1">，证明了解在模 <img src="https://www.zhihu.com/equation?tex=%20%20M%20%20" alt="  M  " class="ee_img tr_noresize" eeimg="1"> 下的唯一性。证毕。

## 三、欧拉定理（Euler's Theorem）

**定理**：若 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%20" alt="  a  " class="ee_img tr_noresize" eeimg="1"> 与 <img src="https://www.zhihu.com/equation?tex=%20%20n%20%20" alt="  n  " class="ee_img tr_noresize" eeimg="1"> 互质，则

<img src="https://www.zhihu.com/equation?tex=%20a%5E%7B%5Cphi%28n%29%7D%20%5Cequiv%201%20%5Cpmod%7Bn%7D%2C%20%5C%5C" alt=" a^{\phi(n)} \equiv 1 \pmod{n}, \\" class="ee_img tr_noresize" eeimg="1">

其中 <img src="https://www.zhihu.com/equation?tex=%20%20%5Cphi%28n%29%20%20" alt="  \phi(n)  " class="ee_img tr_noresize" eeimg="1"> 是欧拉函数，表示小于 <img src="https://www.zhihu.com/equation?tex=%20%20n%20%20" alt="  n  " class="ee_img tr_noresize" eeimg="1"> 且与 <img src="https://www.zhihu.com/equation?tex=%20%20n%20%20" alt="  n  " class="ee_img tr_noresize" eeimg="1"> 互质的正整数个数。

**证明**：设 <img src="https://www.zhihu.com/equation?tex=%20%20S%20%3D%20%5C%7B%20r_1%2C%20r_2%2C%20%5Cldots%2C%20r_%7B%5Cphi%28n%29%7D%20%5C%7D%20%20" alt="  S = \{ r_1, r_2, \ldots, r_{\phi(n)} \}  " class="ee_img tr_noresize" eeimg="1"> 为模 <img src="https://www.zhihu.com/equation?tex=%20%20n%20%20" alt="  n  " class="ee_img tr_noresize" eeimg="1"> 的简化剩余系。因为 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%20" alt="  a  " class="ee_img tr_noresize" eeimg="1"> 与 <img src="https://www.zhihu.com/equation?tex=%20%20n%20%20" alt="  n  " class="ee_img tr_noresize" eeimg="1"> 互质，同样根据同余的性质，对于每个 <img src="https://www.zhihu.com/equation?tex=%20%20r_i%20%5Cin%20S%20%20" alt="  r_i \in S  " class="ee_img tr_noresize" eeimg="1">，<img src="https://www.zhihu.com/equation?tex=%20%20a%20%5Ccdot%20r_i%20%20" alt="  a \cdot r_i  " class="ee_img tr_noresize" eeimg="1"> 模 <img src="https://www.zhihu.com/equation?tex=%20%20n%20%20" alt="  n  " class="ee_img tr_noresize" eeimg="1"> 后仍属于 <img src="https://www.zhihu.com/equation?tex=%20%20S%20%20" alt="  S  " class="ee_img tr_noresize" eeimg="1">，且互不相同（证明过程与费马小定理中证明 <img src="https://www.zhihu.com/equation?tex=%20%20a%20%5Ccdot%20x%20%20" alt="  a \cdot x  " class="ee_img tr_noresize" eeimg="1"> 模 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 结果互不相同类似）。所以，集合 <img src="https://www.zhihu.com/equation?tex=%20%20%5C%7B%20a%20r_1%2C%20a%20r_2%2C%20%5Cldots%2C%20a%20r_%7B%5Cphi%28n%29%7D%20%5C%7D%20%20" alt="  \{ a r_1, a r_2, \ldots, a r_{\phi(n)} \}  " class="ee_img tr_noresize" eeimg="1"> 是 <img src="https://www.zhihu.com/equation?tex=%20%20S%20%20" alt="  S  " class="ee_img tr_noresize" eeimg="1"> 的一个排列。

然后比较两个集合元素的乘积：

<img src="https://www.zhihu.com/equation?tex=%20%5Cprod_%7Bi%20%3D%201%7D%5E%7B%5Cphi%28n%29%7D%20%28a%20r_i%29%20%5Cequiv%20%5Cprod_%7Bi%20%3D%201%7D%5E%7B%5Cphi%28n%29%7D%20r_i%20%5Cpmod%7Bn%7D.%20%5C%5C" alt=" \prod_{i = 1}^{\phi(n)} (a r_i) \equiv \prod_{i = 1}^{\phi(n)} r_i \pmod{n}. \\" class="ee_img tr_noresize" eeimg="1">

对左边进行化简，根据乘法结合律可得 <img src="https://www.zhihu.com/equation?tex=%20%20a%5E%7B%5Cphi%28n%29%7D%20%5Cprod%20r_i%20%20" alt="  a^{\phi(n)} \prod r_i  " class="ee_img tr_noresize" eeimg="1">，右边为 <img src="https://www.zhihu.com/equation?tex=%20%20%5Cprod%20r_i%20%20" alt="  \prod r_i  " class="ee_img tr_noresize" eeimg="1">，即：

<img src="https://www.zhihu.com/equation?tex=%20a%5E%7B%5Cphi%28n%29%7D%20%5Cprod%20r_i%20%5Cequiv%20%5Cprod%20r_i%20%5Cpmod%7Bn%7D.%20%5C%5C" alt=" a^{\phi(n)} \prod r_i \equiv \prod r_i \pmod{n}. \\" class="ee_img tr_noresize" eeimg="1">

因为 <img src="https://www.zhihu.com/equation?tex=%20%20%5Cprod%20r_i%20%20" alt="  \prod r_i  " class="ee_img tr_noresize" eeimg="1"> 中的每个 <img src="https://www.zhihu.com/equation?tex=%20%20r_i%20%20" alt="  r_i  " class="ee_img tr_noresize" eeimg="1"> 都与 <img src="https://www.zhihu.com/equation?tex=%20%20n%20%20" alt="  n  " class="ee_img tr_noresize" eeimg="1"> 互质，根据互质的性质，它们的乘积 <img src="https://www.zhihu.com/equation?tex=%20%20%5Cprod%20r_i%20%20" alt="  \prod r_i  " class="ee_img tr_noresize" eeimg="1"> 也与 <img src="https://www.zhihu.com/equation?tex=%20%20n%20%20" alt="  n  " class="ee_img tr_noresize" eeimg="1"> 互质。再依据同余的消去律，两边同时约去 <img src="https://www.zhihu.com/equation?tex=%20%20%5Cprod%20r_i%20%20" alt="  \prod r_i  " class="ee_img tr_noresize" eeimg="1">，得到：

<img src="https://www.zhihu.com/equation?tex=%20a%5E%7B%5Cphi%28n%29%7D%20%5Cequiv%201%20%5Cpmod%7Bn%7D.%20%5C%5C" alt=" a^{\phi(n)} \equiv 1 \pmod{n}. \\" class="ee_img tr_noresize" eeimg="1">

证毕。

### 四、威尔逊定理（Wilson's Theorem）

**定理**：素数 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 满足

<img src="https://www.zhihu.com/equation?tex=%20%28p%20-%201%29%21%20%5Cequiv%20-1%20%5Cpmod%7Bp%7D.%20%5C%5C" alt=" (p - 1)! \equiv -1 \pmod{p}. \\" class="ee_img tr_noresize" eeimg="1">

且当且仅当 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 是素数时，上式成立。

**证明**：**必要性**（若 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 是素数，则 <img src="https://www.zhihu.com/equation?tex=%20%20%28p%20-%201%29%21%20%5Cequiv%20-1%20%5Cpmod%7Bp%7D%20%20" alt="  (p - 1)! \equiv -1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">）：在模 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 的乘法群 <img src="https://www.zhihu.com/equation?tex=%20%20%5Cmathbb%7BZ%7D_p%5E%2A%20%3D%20%5C%7B1%2C%202%2C%20%5Cldots%2C%20p%20-%201%5C%7D%20%20" alt="  \mathbb{Z}_p^* = \{1, 2, \ldots, p - 1\}  " class="ee_img tr_noresize" eeimg="1"> 中，根据预备知识2，对于每个元素 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%20" alt="  x  " class="ee_img tr_noresize" eeimg="1"> 都存在唯一的逆元 <img src="https://www.zhihu.com/equation?tex=%20%20y%20%20" alt="  y  " class="ee_img tr_noresize" eeimg="1"> ，使得 <img src="https://www.zhihu.com/equation?tex=%20%20xy%20%5Cequiv%201%20%5Cpmod%7Bp%7D%20%20" alt="  xy \equiv 1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">。除了 <img src="https://www.zhihu.com/equation?tex=%20%201%20%20" alt="  1  " class="ee_img tr_noresize" eeimg="1"> 和 <img src="https://www.zhihu.com/equation?tex=%20%20p%20-%201%20%5Cequiv%20-1%20%5Cpmod%7Bp%7D%20%20" alt="  p - 1 \equiv -1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1"> 这两个特殊元素，其他元素的逆元均不等于自身。这是因为若 <img src="https://www.zhihu.com/equation?tex=%20%20x%5E2%20%5Cequiv%201%20%5Cpmod%7Bp%7D%20%20" alt="  x^2 \equiv 1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">，移项可得 <img src="https://www.zhihu.com/equation?tex=%20%20x%5E2%20-%201%20%5Cequiv%200%20%5Cpmod%7Bp%7D%20%20" alt="  x^2 - 1 \equiv 0 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">，因式分解为 <img src="https://www.zhihu.com/equation?tex=%20%20%28x%20-%201%29%28x%20%2B%201%29%20%5Cequiv%200%20%5Cpmod%7Bp%7D%20%20" alt="  (x - 1)(x + 1) \equiv 0 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">，根据素数的性质，<img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 整除 <img src="https://www.zhihu.com/equation?tex=%20%20x%20-%201%20%20" alt="  x - 1  " class="ee_img tr_noresize" eeimg="1"> 或 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 整除 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%2B%201%20%20" alt="  x + 1  " class="ee_img tr_noresize" eeimg="1"> ，即 <img src="https://www.zhihu.com/equation?tex=%20%20x%20%5Cequiv%20%5Cpm1%20%5Cpmod%7Bp%7D%20%20" alt="  x \equiv \pm1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">。所以，<img src="https://www.zhihu.com/equation?tex=%20%20%28p%20-%201%29%21%20%20" alt="  (p - 1)!  " class="ee_img tr_noresize" eeimg="1"> 可以表示为：

<img src="https://www.zhihu.com/equation?tex=%201%20%5Ccdot%20%28-1%29%20%5Ccdot%20%5Cprod_%7Bx%20%5Cneq%20%5Cpm1%7D%20%28x%20%5Ccdot%20x%5E%7B-1%7D%29%20%5Cequiv%20-1%20%5Cpmod%7Bp%7D.%20%5C%5C" alt=" 1 \cdot (-1) \cdot \prod_{x \neq \pm1} (x \cdot x^{-1}) \equiv -1 \pmod{p}. \\" class="ee_img tr_noresize" eeimg="1">

**充分性**（若 <img src="https://www.zhihu.com/equation?tex=%20%20%28p%20-%201%29%21%20%5Cequiv%20-1%20%5Cpmod%7Bp%7D%20%20" alt="  (p - 1)! \equiv -1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">，则 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 是素数）：采用反证法，假设 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 是合数，则存在 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%20" alt="  d  " class="ee_img tr_noresize" eeimg="1"> 满足 <img src="https://www.zhihu.com/equation?tex=%20%201%20%3C%20d%20%3C%20p%20%20" alt="  1 < d < p  " class="ee_img tr_noresize" eeimg="1"> 且 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%5Cmid%20p%20%20" alt="  d \mid p  " class="ee_img tr_noresize" eeimg="1">。因为 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%5Cleq%20p%20-%201%20%20" alt="  d \leq p - 1  " class="ee_img tr_noresize" eeimg="1">，所以 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%20" alt="  d  " class="ee_img tr_noresize" eeimg="1"> 是 <img src="https://www.zhihu.com/equation?tex=%20%20%28p%20-%201%29%21%20%20" alt="  (p - 1)!  " class="ee_img tr_noresize" eeimg="1"> 的因子，即 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%5Cmid%20%28p%20-%201%29%21%20%20" alt="  d \mid (p - 1)!  " class="ee_img tr_noresize" eeimg="1">。但已知 <img src="https://www.zhihu.com/equation?tex=%20%20%28p%20-%201%29%21%20%5Cequiv%20-1%20%5Cpmod%7Bp%7D%20%20" alt="  (p - 1)! \equiv -1 \pmod{p}  " class="ee_img tr_noresize" eeimg="1">，这意味着 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%5Cmid%20%28%28p%20-%201%29%21%20%2B%201%29%20%20" alt="  p \mid ((p - 1)! + 1)  " class="ee_img tr_noresize" eeimg="1">，那么 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%5Cmid%20%28%28p%20-%201%29%21%20%2B%201%29%20%20" alt="  d \mid ((p - 1)! + 1)  " class="ee_img tr_noresize" eeimg="1">。又因为 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%5Cmid%20%28p%20-%201%29%21%20%20" alt="  d \mid (p - 1)!  " class="ee_img tr_noresize" eeimg="1">，根据整除的性质，若 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%5Cmid%20m%20%20" alt="  d \mid m  " class="ee_img tr_noresize" eeimg="1"> 且 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%5Cmid%20n%20%20" alt="  d \mid n  " class="ee_img tr_noresize" eeimg="1"> ，则 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%5Cmid%20%28m%20-%20n%29%20%20" alt="  d \mid (m - n)  " class="ee_img tr_noresize" eeimg="1"> ，所以 <img src="https://www.zhihu.com/equation?tex=%20%20d%20%5Cmid%201%20%20" alt="  d \mid 1  " class="ee_img tr_noresize" eeimg="1">，这与 <img src="https://www.zhihu.com/equation?tex=%20%201%20%3C%20d%20%3C%20p%20%20" alt="  1 < d < p  " class="ee_img tr_noresize" eeimg="1"> 矛盾，因此 <img src="https://www.zhihu.com/equation?tex=%20%20p%20%20" alt="  p  " class="ee_img tr_noresize" eeimg="1"> 必为素数。

证毕。



Reference:

